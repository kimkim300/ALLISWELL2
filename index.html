<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALL IS WELL 🌱</title>
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- 파비콘 (브라우저 탭 아이콘) -->
    <!-- 여러 크기 지원 - 각 크기별 파일이 있으면 사용, 없으면 favicon.png 사용 -->
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png?v=4">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png?v=4">
    <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png?v=4">
    <link rel="icon" type="image/png" sizes="192x192" href="favicon-192x192.png?v=4">
    <link rel="shortcut icon" type="image/png" href="favicon.png?v=4">
    
    <!-- 모바일 홈 화면 아이콘 (192x192 이상 권장) -->
    <link rel="apple-touch-icon" sizes="192x192" href="favicon-192x192.png?v=4">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon-180x180.png?v=4">
    <link rel="apple-touch-icon" sizes="152x152" href="favicon-152x152.png?v=4">
    <link rel="apple-touch-icon" sizes="144x144" href="favicon-144x144.png?v=4">
    <link rel="apple-touch-icon" sizes="120x120" href="favicon-120x120.png?v=4">
    <link rel="apple-touch-icon" sizes="114x114" href="favicon-114x114.png?v=4">
    <link rel="apple-touch-icon" sizes="76x76" href="favicon-76x76.png?v=4">
    <link rel="apple-touch-icon" sizes="72x72" href="favicon-72x72.png?v=4">
    <link rel="apple-touch-icon" sizes="60x60" href="favicon-60x60.png?v=4">
    <link rel="apple-touch-icon" sizes="57x57" href="favicon-57x57.png?v=4">
    <!-- 기본 아이콘 (파일이 없을 경우) -->
    <link rel="apple-touch-icon" href="favicon.png?v=4">
    
    <!-- PWA 및 모바일 설정 -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ALL IS WELL 🌱">
    <meta name="theme-color" content="#6C5CE7">
    <meta name="msapplication-TileColor" content="#6C5CE7">
    <meta name="msapplication-TileImage" content="favicon-192x192.png">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 로그인/회원가입 화면 -->
    <div id="authScreen" class="auth-screen">
        <div class="auth-container">
            <h1>ALL IS WELL 🌱</h1>
            <p class="auth-subtitle">일정 관리 앱에 오신 것을 환영합니다</p>
            
            <!-- 로그인 탭 -->
            <div id="loginTab" class="auth-tab active">
                <h2>로그인</h2>
                <form id="loginForm" class="auth-form">
                    <input type="email" id="loginEmail" placeholder="이메일" required>
                    <input type="password" id="loginPassword" placeholder="비밀번호" required>
                    <button type="submit" class="auth-btn">로그인</button>
                    <p class="auth-switch">계정이 없으신가요? <a href="#" id="showSignUp">회원가입</a></p>
                </form>
                <div id="loginError" class="error-message"></div>
                <div class="test-account-section">
                    <p class="test-account-text">처음 사용하시나요?</p>
                    <button type="button" id="testAccountBtn" class="test-account-btn">테스트 계정으로 시작하기</button>
                    <p class="test-account-info">테스트 계정이 자동으로 생성됩니다</p>
                </div>
            </div>
            
            <!-- 회원가입 탭 -->
            <div id="signUpTab" class="auth-tab">
                <h2>회원가입</h2>
                <form id="signUpForm" class="auth-form">
                    <input type="text" id="signUpName" placeholder="이름" required>
                    <input type="email" id="signUpEmail" placeholder="이메일" required>
                    <input type="password" id="signUpPassword" placeholder="비밀번호 (6자 이상)" required minlength="6">
                    <button type="submit" class="auth-btn">회원가입</button>
                    <p class="auth-switch">이미 계정이 있으신가요? <a href="#" id="showLogin">로그인</a></p>
                </form>
                <div id="signUpError" class="error-message"></div>
            </div>
        </div>
    </div>

    <!-- 로딩 화면 -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-spinner"></div>
        <p>로딩 중...</p>
    </div>

    <!-- 앱 화면 (로그인 후) -->
    <div id="appScreen" class="container" style="display: none;">
        <header>
            <div class="title-container">
                <h1 id="appTitle" class="editable-title">ALL IS WELL 🌱</h1>
                <button class="edit-title-btn" id="editTitleBtn" title="제목 수정">✏️</button>
                <input type="text" id="titleInput" class="title-input" style="display: none;" maxlength="30">
            </div>
            <div class="header-actions">
                <button class="action-btn" id="goalToggleBtn">
                    <span>📋</span> 이번 달 목표
                </button>
                <button class="action-btn" id="chartBtn">
                    <span>📊</span> 집중도 그래프
                </button>
            </div>
        </header>

        <div class="main-content">
            <!-- 달력 섹션 -->
            <div class="calendar-section">
                <div class="calendar-header">
                    <button class="nav-btn" id="prevMonth">‹</button>
                    <h2 id="currentMonthYear"></h2>
                    <button class="nav-btn" id="nextMonth">›</button>
                </div>
                <div class="calendar-grid" id="calendarGrid"></div>
            </div>

            <!-- 일정 섹션 -->
            <div class="tasks-section">
                <div class="tasks-header">
                    <h3 id="selectedDateTitle">일정</h3>
                </div>
                <div class="task-list" id="taskList"></div>
                <button class="add-task-btn" id="addTaskBtn">
                    <span>+</span> 일정 추가
                </button>
            </div>
        </div>
        
        <!-- 로그아웃 및 비밀번호 변경 버튼 -->
        <div class="logout-section">
            <button class="logout-btn" id="changePasswordBtn" style="background: rgba(52, 152, 219, 0.9); margin-bottom: 10px;">비밀번호 변경</button>
            <button class="logout-btn" id="logoutBtn">로그아웃</button>
        </div>
    </div>

    <!-- 일정 추가/수정 모달 -->
    <div class="modal" id="taskModal">
        <div class="modal-content">
            <span class="close" id="closeTaskModal">&times;</span>
            <h3 id="modalTitle">일정 추가</h3>
            <form id="taskForm">
                <input type="text" id="taskTitle" placeholder="일정 제목" required>
                
                <div class="category-selector">
                    <select id="taskCategory" required>
                        <option value="">카테고리 선택</option>
                    </select>
                    <button type="button" class="manage-category-btn" id="manageCategoryBtn" title="카테고리 관리">⚙️</button>
                </div>

                <div class="category-manager" id="categoryManager" style="display: none;">
                    <div class="category-manager-header">
                        <h4>카테고리 관리</h4>
                        <button type="button" class="add-category-inline-btn" id="addCategoryInlineBtn">+ 추가</button>
                    </div>
                    <div class="category-manager-list" id="categoryManagerList"></div>
                </div>

                <textarea id="taskDescription" placeholder="상세 설명 (선택)"></textarea>
                <div class="modal-buttons">
                    <button type="submit" class="save-btn">저장</button>
                    <button type="button" class="cancel-btn" id="cancelTaskBtn">취소</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 카테고리 추가/수정 모달 -->
    <div class="modal" id="categoryModal">
        <div class="modal-content">
            <span class="close" id="closeCategoryModal">&times;</span>
            <h3 id="categoryModalTitle">카테고리 추가</h3>
            <form id="categoryForm">
                <input type="text" id="categoryName" placeholder="카테고리 이름" required>
                <div class="color-picker-wrapper">
                    <label>색상 선택</label>
                    <div class="color-palette" id="colorPalette">
                        <div class="color-option" data-color="#6C5CE7" style="background: #6C5CE7;" title="보라색"></div>
                        <div class="color-option" data-color="#00B894" style="background: #00B894;" title="청록색"></div>
                        <div class="color-option" data-color="#FD79A8" style="background: #FD79A8;" title="분홍색"></div>
                        <div class="color-option" data-color="#FDCB6E" style="background: #FDCB6E;" title="노란색"></div>
                        <div class="color-option" data-color="#55A3FF" style="background: #55A3FF;" title="파란색"></div>
                        <div class="color-option" data-color="#E17055" style="background: #E17055;" title="주황색"></div>
                        <div class="color-option" data-color="#00D2D3" style="background: #00D2D3;" title="하늘색"></div>
                        <div class="color-option" data-color="#A29BFE" style="background: #A29BFE;" title="연보라색"></div>
                        <div class="color-option" data-color="#2ECC71" style="background: #2ECC71;" title="초록색"></div>
                        <div class="color-option" data-color="#E74C3C" style="background: #E74C3C;" title="빨간색"></div>
                    </div>
                    <input type="hidden" id="categoryColor" value="#6C5CE7">
                </div>
                <div class="modal-buttons">
                    <button type="submit" class="save-btn">저장</button>
                    <button type="button" class="cancel-btn" id="cancelCategoryBtn">취소</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 비밀번호 변경 모달 -->
    <div class="modal" id="changePasswordModal">
        <div class="modal-content">
            <span class="close" id="closeChangePasswordModal">&times;</span>
            <h3>비밀번호 변경</h3>
            <form id="changePasswordForm">
                <input type="password" id="currentPassword" placeholder="현재 비밀번호" required>
                <input type="password" id="newPassword" placeholder="새 비밀번호 (6자 이상)" required minlength="6">
                <input type="password" id="confirmPassword" placeholder="새 비밀번호 확인" required minlength="6">
                <div id="changePasswordError" class="error-message"></div>
                <div class="modal-buttons">
                    <button type="submit" class="save-btn">변경</button>
                    <button type="button" class="cancel-btn" id="cancelChangePasswordBtn">취소</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 월별 목표 모달 -->
    <div class="modal" id="goalModal">
        <div class="modal-content goal-modal-content">
            <span class="close" id="closeGoalModal">&times;</span>
            <h3>이번 달 목표</h3>
            <form id="goalForm">
                <textarea id="monthlyGoal" placeholder="이번 달 목표를 입력하세요..."></textarea>
                <div class="modal-buttons">
                    <button type="submit" class="save-btn">저장</button>
                    <button type="button" class="cancel-btn" id="cancelGoalBtn">취소</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 그래프 팝업 -->
    <div class="modal" id="chartModal">
        <div class="modal-content chart-modal-content">
            <span class="close" id="closeChartModal">&times;</span>
            <h3>이번 달 집중도</h3>
            <div class="chart-container">
                <canvas id="focusChart"></canvas>
                <div class="chart-legend" id="chartLegend"></div>
            </div>
            <p class="chart-description">완료된 일정 기준으로 카테고리별 집중도를 보여줍니다.</p>
        </div>
    </div>

    <!-- Firebase SDK 및 앱 스크립트 -->
    <script type="module" src="firebase-config.js"></script>
    <script type="module" src="auth.js"></script>
    <script type="module" src="script.js"></script>
</body>
</html>
